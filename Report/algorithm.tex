\section{Algorithm}
\label{sec:algorithm}

\textcolor{red}{The third section should present the evolutionary approach you developed. You can divide this section into subsection. In any case, you should mention the following details:}

\textcolor{red}{\textbf{Evolutionary approach.} Clearly describe the algorithm you developed. You should clearly explain the evolutionary operators you used and what modifications you did to match the problem. It is extremely important to present also a pseudocode of your algorithm. An example is given in \ref{alg:pseudocode_example}, below. For more insight into presentation of algorithms, you can advise \cite{zobel2014algorithms}.}

{
\color{red}To typeset pseudocode in \LaTeX\ you can use one of the following options:
\begin{itemize}
    \item Choose ONE of the (\texttt{algpseudocode} OR \texttt{algcompatible} OR \texttt{algorithmic}) packages to typeset algorithm bodies, and the algorithm package for captioning the algorithm.
    \item The \texttt{algorithm2e} package.
\end{itemize}
You can find more information here: \url{https://www.overleaf.com/learn/latex/Algorithms}
}

\begin{algorithm}
\caption{Example of an algorithm's pseudocode}\label{alg:pseudocode_example}
\begin{algorithmic}
\Require $n \geq 0$
\Ensure $y = x^n$
\State $y \gets 1$
\State $X \gets x$
\State $N \gets n$
\While{$N \neq 0$}
\If{$N$ is even}
    \State $X \gets X \times X$
    \State $N \gets \frac{N}{2}$  \Comment{This is a comment}
\ElsIf{$N$ is odd}
    \State $y \gets y \times X$
    \State $N \gets N - 1$
\EndIf
\EndWhile
\end{algorithmic}
\end{algorithm}

\textcolor{red}{\textbf{Solution representation.} Clearly describe the solution representation you used. You can use figures to improve the comprehensibility of this part.}

\textcolor{red}{\textbf{Fitness function.} It is also very important to mention the fitness function you used. In many cases, the objective function of the problem is not the same as the fitness function used in an evolutionary algorithm. An example, following the principles of \cite{zobel2014mathematics}, is given below.}

\begin{equation}
    F = \sum_{i=1}^d x_i^2 
\end{equation}
where $x_i$ is the $i$-th gene (i.e., decision variable) in the solution and $d$ corresponds to the number of decision variables in the problem.

\textcolor{red}{\textbf{Note:} Change the section's title to match the name of the algorithm you developed for your assignment.}

\subsection{Evolutionary Algorithm Implementations}
This section presents and compares different implementations of an evolutionary algorithm designed to solve Sudoku puzzles. Each implementation varies in its approach to selection, crossover, mutation strategies, and fitness evaluation.

The following sections document these processes and use the Sudoku board shown in \nameref{fig:initial-sudoku} as a reference for visualizing the selection and mutation step.

\begin{figure}[h]
\centering
\resizebox{0.5\textwidth}{!}{
  \begin{minipage}{\textwidth}
    \begin{sudoku}
    | |2| | | | | |3|1|.
    |7| | | | |3| | | |.
    | | | |1|4| |2|9| |.
    | |5|2|7|6|4| |1|8|.
    | |6|3| |1|2|7|5|9|.
    | |7|8| | | |4| | |.
    |2| | |3|7| | | |5|.
    | |1| | | | |9| | |.
    |5|4| | |8|1| | | |.
    \end{sudoku}
  \end{minipage}%
}
\caption{Initial Sudoku puzzle}
\label{fig:initial-sudoku}
\end{figure}

\subsubsection{Implementation 1}
\begin{enumerate}
\item Initialize the population with \textit{\textbf{population\_size}} random individuals that all respect the initially given sudoku tiles. These individuals will start out with random values in the empty tiles. The fitness of each individual is calculated as the sum of the number of unique numbers in each row, column, and 3x3 subgrid. The maximum fitness is 243 (9 unique numbers * 9 rows + 9 columns + 9 subgrids).
\item The next generation of individuals is created by selecting two parents (or the same one twice) randomly from the top 20\% of the current population. These top parents will create 80\% of the next generation's individuals. The other 20\% of individuals will have parents that are chosen the entire population.
\item We perform random crossover, iterating over each cell and randomly choosing whether the child inherits the value from the first or second parent.
\item Afterwards, the child mutates \textit{\textbf{mutation\_amount}} random tiles on the board, changing their value. Any change on the initially given sudoku tiles is not allowed.
\item Once the new generation is created, we calculate the fitness of each individual and repeat the process from step 2. until a valid solution is found.
\end{enumerate}

\paragraph{Selection} The \nameref{fig:impl-1-selection} depicts how two parents (left and middle) of the current generation form an individual of the next generation (right).
One area for improvement is evident in row 7: Parent~1 contains two occurrences of the digit 7 and Parent~2 contains three. The offspring also has three 7s, while it would have been possible to generate a row with all distinct digits, namely \textbf{286371945}.

\begin{figure}[h]
  \centering
  {\setlength{\tabcolsep}{-9pt}
  \renewcommand{\arraystretch}{1.5}
   \begin{tabular}{c c c c c}
    % first board
    \begin{adjustbox}{width=0.38\textwidth,valign=c}
      \begin{minipage}{\linewidth}
        \begin{sudoku}
        |6|2|9|5|7|6|7|3|1|.
        |7|8|5|6|9|3|1|2|7|.
        |1|3|4|1|4|7|2|9|5|.
        |4|5|2|7|6|4|4|1|8|.
        |9|6|3|8|1|2|7|5|9|.
        |9|7|8|2|9|5|4|6|2|.
        |2|2|6|3|7|7|9|4|5|.
        |4|1|6|2|2|3|9|7|9|.
        |5|4|1|2|8|1|3|4|8|.
        \end{sudoku}
      \end{minipage}
    \end{adjustbox}
    & % plus sign
    {\begin{adjustbox}{valign=c}\Large$+$\end{adjustbox}}
    &
    % second board
    \begin{adjustbox}{width=0.38\textwidth,valign=c}
      \begin{minipage}{\linewidth}
        \begin{sudoku}
        |8|2|6|7|7|5|7|3|1|.
        |7|1|3|9|8|3|8|2|4|.
        |1|5|5|1|4|7|2|9|3|.
        |9|5|2|7|6|4|1|1|8|.
        |4|6|3|9|1|2|7|5|9|.
        |3|7|8|5|9|1|4|6|3|.
        |2|8|7|3|7|1|7|4|5|.
        |3|1|6|4|2|3|9|7|2|.
        |5|4|4|2|8|1|3|4|3|.
        \end{sudoku}
      \end{minipage}
    \end{adjustbox}
    & % equals sign
    {\begin{adjustbox}{valign=c}\Large$=$\end{adjustbox}}
    &
    % third board
    \begin{adjustbox}{width=0.38\textwidth,valign=c}
      \begin{minipage}{\linewidth}
        \begin{sudoku}
        |8|2|9|7|7|6|7|3|1|.
        |7|1|5|6|8|3|1|2|4|.
        |1|3|5|1|4|7|2|9|5|.
        |9|5|2|7|6|4|1|1|8|.
        |9|6|3|8|1|2|7|5|9|.
        |3|7|8|5|9|1|4|6|3|.
        |2|2|6|3|7|7|7|4|5|.
        |4|1|6|4|2|3|9|7|9|.
        |5|4|1|2|8|1|3|4|3|.
        \end{sudoku}
      \end{minipage}
    \end{adjustbox}
   \end{tabular}
  }
  \caption{Exemplary selection step according to Implementation 1}
  \label{fig:impl-1-selection}
\end{figure}

\paragraph{Mutation} Figure~\ref{fig:impl-1-mutation} illustrates a mutation step with mutation rate \(n=2\); however, only a single tile (row 7, column 7) was actually modified. The other candidate position coincided with a given cell and therefore could not be changed. This behaviour highlights a weakness of the implementation: mutations can be wasted when selected positions are immutable, and a single mutation may decrease fitness by introducing additional conflicts (in this example the row contains three 7s, the column contains one 7 and the corresponding 3×3 block contains two 7s), which lowers the individual’s score.

\begin{figure}[h]
  \centering
  {\setlength{\tabcolsep}{0pt}
  \renewcommand{\arraystretch}{1.5}
   \begin{tabular}{c c c}
    % first board
    \begin{adjustbox}{width=0.38\textwidth,valign=c}
      \begin{minipage}{\linewidth}
        \begin{sudoku}
        |8|2|9|7|7|6|7|3|1|.
        |7|1|5|6|8|3|1|2|4|.
        |1|3|5|1|4|7|2|9|5|.
        |9|5|2|7|6|4|1|1|8|.
        |9|6|3|8|1|2|7|5|9|.
        |3|7|8|5|9|1|4|6|3|.
        |2|2|6|3|7|7|7|4|5|.
        |4|1|6|4|2|3|9|7|9|.
        |5|4|1|2|8|1|3|4|3|.
        \end{sudoku}
      \end{minipage}
    \end{adjustbox}
    & % plus sign
      {\begin{adjustbox}{valign=c}
       \shortstack{mutation\\[2pt]\Large$\longrightarrow$}
     \end{adjustbox}}
    &
    % second board
    \begin{adjustbox}{width=0.38\textwidth,valign=c}
      \begin{minipage}{\linewidth}
        \begin{sudoku}
        |8|2|9|7|7|6|7|3|1|.
        |7|1|5|6|8|3|1|2|4|.
        |1|3|5|1|4|7|2|9|5|.
        |9|5|2|7|6|4|1|1|8|.
        |9|6|3|8|1|2|7|5|9|.
        |3|7|8|5|9|1|4|6|3|.
        |2|2|6|3|7|7|7|7|5|.
        |4|1|6|4|2|3|9|7|9|.
        |5|4|1|2|8|1|3|4|3|.
        \end{sudoku}
      \end{minipage}
    \end{adjustbox}
   \end{tabular}
  }
  \caption{Exemplary mutation step according to Implementation 1}
  \label{fig:impl-1-mutation}
\end{figure}

\paragraph{Problem}
This implementation leads to a situation where the diversity of the population decreases rapidly, resulting in premature convergence to suboptimal solutions. On most of the runs, the algorithm creates more than 100,000 generations before finding a valid solution.  
To counter this problem, we have tried to increase the mutation rate and the population size, as well as introducing new random individuals in each generation. However, these adjustments only led to marginal improvements in performance.

\subsubsection{Implementation 2}
\begin{enumerate}
\item Initialize the population with \textit{\textbf{population\_size}} number of random individuals that all respect the initially given sudoku tiles. The individuals create a complete board by iterating over the rows and filling in the empty tiles with random numbers that do not already exist in the respective row. The fitness function works counterintuitively, calculating the fitness as the sum of the number of duplicates in each column, and 3x3 subgrid. The minimum fitness is 0 (no duplicates).
\item The next generation starts with the top \textit{\textbf{elites\_size}} number of individuals from the current population. Then, a tournament selection is performed to select parents for the remaining individuals in the next generation. In each tournament, \textit{\textbf{K}} individuals are randomly chosen from the population, and the one with the best fitness is selected as a parent. This selection process is repeated until we have \textit{\textbf{population\_size}} number of parents.
\item The crossover step is done by iterating over all parents in pairs, creating two children from each pair. For each row in the sudoku board, the child inherits that row either from the first or the second parent. This ensures that the children will still respect the uniqueness of numbers in each row.
\item For mutation, we iterate all rows of an individual and swap two random tiles that both haven't been given in the initial sudoku. We do this with the probability of \textit{\textbf{mutation\_rate}} for each row, once again ensuring the uniqueness of numbers in each row.
\item Once the new generation is created, we calculate the fitness of each individual and repeat the process from step 2. until a valid solution is found.
\end{enumerate}

\begin{verbatim}
+=======+=======+=======+ + +=======+=======+=======+ = +=======+=======+=======+ ~ +=======+=======+=======+
| 9 2 4 | 6 7 8 | 5 3 1 | + | 8 2 4 | 7 9 6 | 5 3 1 | = | 8 2 4 | 7 9 6 | 5 3 1 | ~ | 8 2 4 | 6 9 7 | 5 3 1 |
| 7 9 1 | 5 2 3 | 8 6 4 | + | 7 9 1 | 5 2 3 | 6 8 4 | = | 7 9 1 | 5 2 3 | 6 8 4 | ~ | 7 9 1 | 5 2 3 | 6 8 4 |
| 8 3 5 | 1 4 6 | 2 9 7 | + | 3 6 7 | 1 4 8 | 2 9 5 | = | 8 3 5 | 1 4 6 | 2 9 7 | ~ | 8 3 5 | 1 4 6 | 2 9 7 |
+=======+=======+=======+ + +=======+=======+=======+ = +=======+=======+=======+ ~ +=======+=======+=======+
| 3 5 2 | 7 6 4 | 9 1 8 | + | 3 5 2 | 7 6 4 | 9 1 8 | = | 3 5 2 | 7 6 4 | 9 1 8 | ~ | 3 5 2 | 7 6 4 | 9 1 8 |
| 4 6 3 | 8 1 2 | 7 5 9 | + | 8 6 3 | 4 1 2 | 7 5 9 | = | 8 6 3 | 4 1 2 | 7 5 9 | ~ | 4 6 3 | 8 1 2 | 7 5 9 |
| 6 7 8 | 5 3 9 | 4 1 2 | + | 1 7 8 | 5 3 9 | 4 2 6 | = | 1 7 8 | 5 3 9 | 4 2 6 | ~ | 1 7 8 | 5 3 9 | 4 2 6 |
+=======+=======+=======+ + +=======+=======+=======+ = +=======+=======+=======+ ~ +=======+=======+=======+
| 2 9 6 | 3 7 4 | 1 8 5 | + | 2 9 6 | 3 7 4 | 1 8 5 | = | 2 9 6 | 3 7 4 | 1 8 5 | ~ | 2 9 6 | 3 7 4 | 1 8 5 |
| 3 1 7 | 2 6 5 | 9 8 4 | + | 3 1 7 | 8 5 6 | 9 4 2 | = | 3 1 7 | 2 6 5 | 9 8 4 | ~ | 3 1 7 | 2 6 5 | 9 8 4 |
| 5 4 9 | 6 8 1 | 3 2 7 | + | 5 4 6 | 9 8 1 | 3 2 7 | = | 5 4 6 | 9 8 1 | 3 2 7 | ~ | 5 4 6 | 9 8 1 | 3 2 7 |
+=======+=======+=======+ + +=======+=======+=======+ = +=======+=======+=======+ ~ +=======+=======+=======+
\end{verbatim}


